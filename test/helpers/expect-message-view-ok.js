const { expectNotifyStatus } = require('./notify-status')
const { navigation } = require('../../server/constants')

module.exports = ($, data) => {
  expect($('.govuk-header__navigation-item--active').text()).toMatch(navigation.header.messages.text)
  expect($('.govuk-phase-banner')).toHaveLength(1)
  const formGroups = $('.govuk-form-group')
  expect(formGroups).toHaveLength(7)
  expect($('label', formGroups.eq(0)).text()).toMatch('Message text')
  expect($('.govuk-hint', formGroups.eq(0)).text()).toMatch('Enter the message to send.')
  expect($('label', formGroups.eq(1)).text()).toMatch('Additional information')
  expect($('.govuk-hint', formGroups.eq(1)).text()).toMatch('Enter any useful additional information.')
  const helpDetails = $('.govuk-details')
  expect(helpDetails).toHaveLength(4)
  expect($('.govuk-details__summary-text', helpDetails.eq(0)).text()).toMatch('Help with message content')
  expect($('.govuk-details__summary-text', helpDetails.eq(1)).text()).toMatch('Help with additional information content')
  expect($('.govuk-details__summary-text', helpDetails.eq(2)).text()).toMatch('Help with sending to organisations')
  expect($('.govuk-details__summary-text', helpDetails.eq(3)).text()).toMatch('Help with sending to office locations')

  expect($('legend', formGroups.eq(2)).text()).toMatch('Select the organisations to send the message to')
  expect($('#officeCodes', formGroups.eq(3)).text()).toMatch('Which office locations should the message be sent to?')
  expect($('#allOffices').val()).toEqual('true')
  expect($('legend', formGroups.eq(4)).text()).toMatch('Do you want to send the message to all office locations')
  expect($('.govuk-checkboxes__item', formGroups.eq(2))).toHaveLength(data.orgList.length)
  expect($('.govuk-accordion__section')).toHaveLength(1)
  expect($('.govuk-accordion__section-header').eq(0).text()).toMatch(data.areaName)
  const officeCheckboxes = $('.govuk-accordion__section-content .govuk-checkboxes__item')
  expect(officeCheckboxes).toHaveLength(1)
  expect(officeCheckboxes.eq(0).text()).toMatch(`All office locations in the ${data.areaName} area`)
  const officeListItems = $('.govuk-list.govuk-list--bullet li')
  expect(officeListItems).toHaveLength(data.officeLocations.length)
  expect(officeListItems.eq(0).text()).toMatch(data.officeLocations[0].officeLocation)
  expect(officeListItems.eq(1).text()).toMatch(data.officeLocations[1].officeLocation)

  expectNotifyStatus($)
}
